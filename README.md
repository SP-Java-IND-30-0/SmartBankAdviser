# SmartBankAdviser
## Описание
Сервис предоставляет персонализированные рекомендации кредитных продуктов для пользователей банка на основе их транзакционной истории и заданных правил. Основной модуль реализован как Spring Boot-приложение, которое взаимодействует с встраиваемой базой данных H2. Сервис предоставляет REST API для получения рекомендаций, управления правилами и сбора статистики их срабатывания. Telegram-бот реализован в виде отдельного микросервиса, который взаимодействует с основным модулем через REST API, отправляя HTTP-запросы для получения рекомендаций по имени пользователя.

## Основные функции
* Получение рекомендаций по ID пользователя через REST API.

* Управление правилами рекомендаций (добавление, удаление, просмотр).

* Кеширование результатов запросов для повышения производительности.

* Telegram-бот как отдельный микросервис, взаимодействующий с основным модулем через REST API.

* Сбор статистики срабатывания правил для анализа их эффективности.

* Сброс кеша рекомендаций через API.

## Технологии:

- **Основные технологии**:
  * **Spring Boot** (для создания микросервиса).

  * **H2** (встраиваемая база данных с информацией об операциях клиентов банка).

  * **PostgresSQL** (база данных для хранения динамических правил)

  * **REST API** (для взаимодействия с внешними системами)

  * **Telegram Bot API** (для интеграции с Telegram)

  * **Liquibase** ( для управления миграциями базы данных)

- **Вспомогательные библиотеки**:
  * **ModelMapper** (для преобразования объектов entity в dto и обратно)
  * **Caffeine** (для кэширования запросов к базе данных)

- **Инструменты для разработки и тестирования**:
  * **Lombok** (для ускорения разработки и повышения читаемости кода)
  * **Testcontainers** (для изоляции интеграционных тестов)
  * **JaCoCo** (для статистики тестирования и оценки качества тестов)

- **Документация**:
  * **Swagger** (для документирования в формате OpenAPI)

## Как использовать
  1. Запустите приложение.

  2. Используйте REST API для получения рекомендаций, управления правилами и сбора статистики.

  3. Запустите Telegram-бот как отдельный микросервис

  4. Взаимодействуйте с Telegram-ботом для получения рекомендаций по имени пользователя.

**Пример запроса к API:**
```
GET /recommendation/cd515076-5d8a-44be-930e-8d4fcb79f42d
```
Ответ:
```
{
  "userId": "cd515076-5d8a-44be-930e-8d4fcb79f42d",
  "recommendations": [
    {
      "id": "147f6a0f-3b91-413b-ab99-87f081d60d5a",
      "name": "Invest 500",
      "text": "Откройте свой путь к успеху с индивидуальным инвестиционным счетом (ИИС) от нашего банка!\nВоспользуйтесь налоговыми льготами и начните инвестировать с умом. Пополните счет до конца\nгода и получите выгоду в виде вычета на взнос в следующем налоговом периоде.\nНе упустите возможность разнообразить свой портфель, снизить риски и следить за актуальными\nрыночными тенденциями. Откройте ИИС сегодня и станьте ближе к финансовой независимости!\n"
    },
    {
      "id": "59efc529-2fff-41af-baff-90ccd7402925",
      "name": "Top Saving",
      "text": "Откройте свою собственную «Копилку» с нашим банком! «Копилка» — это уникальный банковский инструмент,\nкоторый поможет вам легко и удобно накапливать деньги на важные цели. Больше никаких забытых чеков и\nпотерянных квитанций — всё под контролем!\nПреимущества «Копилки»:\nНакопление средств на конкретные цели. Установите лимит и срок накопления, и банк будет автоматически\nпереводить определенную сумму на ваш счет.\nПрозрачность и контроль. Отслеживайте свои доходы и расходы, контролируйте процесс накопления и\nкорректируйте стратегию при необходимости.\nБезопасность и надежность. Ваши средства находятся под защитой банка, а доступ к ним возможен только\nчерез мобильное приложение или интернет-банкинг.\nНачните использовать «Копилку» уже сегодня и станьте ближе к своим финансовым целям!\n"
    }
  ]
}
```

**Команда для Telegram-бота:**
```
/recommend sheila.wolff
```

Ответ:
```
Здравствуйте, Letitia Simonis

Новые продукты для вас:
- Top Saving
Откройте свою собственную «Копилку» с нашим банком! «Копилка» — это уникальный банковский инструмент,
который поможет вам легко и удобно накапливать деньги на важные цели. Больше никаких забытых чеков и
потерянных квитанций — всё под контролем!
```

Полное описание всех команд доступно по ссылке - [Документация REST API](https://github.com/SP-Java-IND-30-0/SmartBankAdviser/wiki/%D0%94%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%86%D0%B8%D1%8F-REST-API)

## Сборка и запуск проекта
Проект поддерживает два способа запуска: локально и с использованием Docker. Подробная инструкция по развертыванию и запуску доступна на странице [Требования по развертыванию и запуску](https://github.com/SP-Java-IND-30-0/SmartBankAdviser/wiki/%D0%A2%D1%80%D0%B5%D0%B1%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F-%D0%BF%D0%BE-%D1%80%D0%B0%D0%B7%D0%B2%D0%B5%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8E-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0).

### Для запуска с помощью Docker:
**1. Клонируйте репозиторий.**
**2. Настройте переменные окружения для Telegram-бота:**
Перейдите в папку модуля Telegram-бота и создайте файл .env в его корневой директории. Укажите в нем токен для бота:
```
TELEGRAM_BOT_TOKEN=ваш_токен
```
**3. Запустите проект с помощью Docker:**
```
docker-compose up --build
```
Эта команда соберет и запустит все необходимые контейнеры, включая основной модуль и Telegram-бот.

**4. Проверка работы:**

* Основной модуль будет доступен по адресу: `http://localhost:8080`.

* Telegram-бот начнет работать после успешного запуска и будет готов к взаимодействию.

## Лицензия
Проект распространяется под лицензией MIT. Подробнее см. в файле [LICENSE](https://github.com/SP-Java-IND-30-0/SmartBankAdviser/blob/master/LICENSE.md).

